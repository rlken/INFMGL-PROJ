<!DOCTYPE html>
<html>

<head>
    <title>Debug Page</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
        }

        .status {
            padding: 10px;
            border: 1px solid #ccc;
            margin-bottom: 10px;
        }

        .success {
            background: #d4edda;
            color: #155724;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
        }
    </style>
</head>

<body>
    <h1>System Diagnostic</h1>

    <div id="status" class="status">Testing connection...</div>
    <pre id="output">Waiting...</pre>

    <script>
        const output = document.getElementById('output');
        const status = document.getElementById('status');

        function log(msg) {
            output.textContent += msg + '\n';
        }

        async function testApi() {
            log('Fetching api/cars...');
            try {
                const response = await fetch('api/cars');
                log('Response Status: ' + response.status + ' ' + response.statusText);

                const text = await response.text();
                log('Response Body:\n' + text);

                if (response.ok) {
                    try {
                        const json = JSON.parse(text);
                        status.textContent = 'SUCCESS: Connected to API. Found ' + json.length + ' cars.';
                        status.className = 'status success';
                    } catch (e) {
                        status.textContent = 'ERROR: Valid response but not JSON.';
                        status.className = 'status error';
                    }
                } else {
                    status.textContent = 'ERROR: Server returned an error code.';
                    status.className = 'status error';
                }
            } catch (err) {
                log('Fetch Error: ' + err.message);
                status.textContent = 'FAILED: Could not reach server.';
                status.className = 'status error';
            }
        }

        testApi();
    </script>
</body>

</html>